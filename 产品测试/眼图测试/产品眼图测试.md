## 产品眼图测试 
### 前瞻知识了解 
#### 1. TP1A信号 和 TP4信号 
TP1A信号是指信号从内部产生并发送到光模块（或电模块）的座子上，即信号由模块来发送（从TX线上发送）  
TP4 信号是指信号从外部产生并发送到光模块（或电模块）的座子上，即信号由模块上接受（从RX线上接受）  

#### 2. 电参调节 
对于脉冲信号，一般有这么三个电参需要调节：  
precursor（预加重），main（峰值电压），postcursor（后加重）  
precursor：一般是提前将电压下降为脉冲信号前面一条边提供更高的斜率，数值越高提前下降的越多.    
main（峰值电压）：调节脉冲电压的峰值电压，一般数值越高峰值电压越高。  
postcursor（后加重）：一般是在脉冲电压之后降低电压，以期提高脉冲电压后面一条边的斜率，数值越高下降的越多。  

#### 3. 眼图指标 

1. 眼高（eye height)：即眼图张开上下的垂直最高差值   
2. 垂直眼眼闭合度：眼图的最高点和最低点的差值和眼高的比值   
3. 眼线性：多个眼图在同一垂直线上，其中最大的眼高和最小的眼高的比值    


#### 4. PAM4 介绍：   


### 眼图测试流程   
OSFP 800G测试流程   

1. 打开产品进行信号源发送   
2. 打开眼图仪,进行校准  
3. 按照信号配置时钟回复,锁住信号,配置码型锁定  
4. 打开自动测试APP  
5. 进行去嵌  
6. 在select tests 中选择auto-tune CTLE,DFE,EYE Opening TP1a中找到最合适的CTLE(即最好的滤波形式)  
7. 在config中配置信号参数,signaling rate,pattern length,Use CTLE and DFE  
8. 点击select tests 中将需要测试的测试项勾起,进行测试 
9. 根据结果进行调参,直到找到合格值  



### 测试流程详细版 
使用串口线将上位机与O2平台网口进行连接,将待测信号源OSFP 800G产品掺入O2平台槽口,打开设备管理器查看连接的端口名称,打开secureCRT终端管理器,选择连接端口设置波特率为115200进行连接.输入账户密码登录AcceLink,输入命令"fpga value set address 0x1f value 0xnn"进入需要调试的单盘口,输入账户密码登录单盘,对传输端口进行码型配置并使能,使其能够输出所需的对应码型.进行OSFP 800G测试时,所需的码型为PRBS 13Q,根据命令配置即可.   
打开眼图仪,点击Tools菜单栏上的Calibration,选择N1060A仪器,将 眼图仪slot 1 channel1A和channel1B接口上所有连接线去除,再点击Calibrate进行校准.校准完成后,对要接受的信号进行设置,打开时钟回复,设置符号率为53.125GBD,设置Rate Drive 为13280,将信号传输通道和眼图仪的slot 1 channel 1A 和channel 1B相连接进行时钟锁定,点击Frame trigger中的pattern Lock setup,同样设置符号率为53.125Gbd,设置Pattern length 为 8191,配置成功则眼图仪设置完成.   
点击菜单栏上的Apps,点击Automated Test Apps,选择N109212CA OIF-CEI 112G, 进入自动测试app中,在 set up中点击Set Channel Skew,勾选Chan 1A/1B 进行去嵌,选择Select tests 菜单,选择Auto tune CTLE,DFE,Eye Opening TP1A,在connect菜单中勾选去除所有连接提示,选择Run test 进行测试,得到CTLE的最佳值,点击configure 菜单,选择信号率 53.125,选择pattern length 8191,点击Use CTLE and DFE, 选择YES,点击Selcets tests 菜单,选择眼图所需的10项测试项目,同样进行测试得出结果.   
主机打开串口终端,配置信号源电参,信号源电参由三种,分别为pre(预加重),main(峰值电压),post(后加重), 
分别调节:  
pre:电压上升前,先下降到谷底,以提高电压上升的斜率   
main:电压上升的最高值   
post: 电压下降时到达的谷底,以提高电压下降的斜率   
通过调节这三个信号源参数,配置信号源来调节先前测试时没有通过的项目,直到调节通过   